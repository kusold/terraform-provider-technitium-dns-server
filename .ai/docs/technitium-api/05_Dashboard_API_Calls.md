# Technitium DNS Server API - Dashboard API Calls

## Dashboard API Calls

These API calls provide access to dashboard stats and allow deleting stat files.

### Get Stats

Returns the DNS stats that are displayed on the web console dashboard.

URL:\
`http://localhost:5380/api/dashboard/stats/get?token=x&type=LastHour&utc=true`

OBSOLETE PATH:\
`api/getStats`

PERMISSIONS:\
Dashboard: View

WHERE:
- `token`: The session token generated by the `login` or the `createToken` call.
- `type` (optional): The duration type for which valid values are: [`LastHour`, `LastDay`, `LastWeek`, `LastMonth`, `LastYear`, `Custom`]. Default value is `LastHour`.
- `utc` (optional): Set to `true` to return the main chart data with labels in UTC date time format using which the labels can be converted into local time for display using the received `labelFormat`.
- `start` (optional): The start date in ISO 8601 format. Applies only to `custom` type.
- `end` (optional): The end date in ISO 8601 format. Applies only to `custom` type.

RESPONSE:
```
{
	"response": {
		"stats": {
			"totalQueries": 925,
			"totalNoError": 834,
			"totalServerFailure": 1,
			"totalNxDomain": 90,
			"totalRefused": 0,
			"totalAuthoritative": 47,
			"totalRecursive": 348,
			"totalCached": 481,
			"totalBlocked": 49,
			"totalDropped": 0,
			"totalClients": 6,
			"zones": 19,
			"cachedEntries": 6330,
			"allowedZones": 10,
			"blockedZones": 1,
			"allowListZones": 0,
			"blockListZones": 307447
		},
		"mainChartData": {
			"labelFormat": "HH:mm",
			"labels": [
				"2024-02-04T10:38:00.0000000Z",
				"2024-02-04T10:39:00.0000000Z",
				"2024-02-04T10:40:00.0000000Z",
				"2024-02-04T10:41:00.0000000Z",
				"2024-02-04T10:42:00.0000000Z",
				"2024-02-04T10:43:00.0000000Z",
				"2024-02-04T10:44:00.0000000Z",
				"2024-02-04T10:45:00.0000000Z",
				"2024-02-04T10:46:00.0000000Z",
				"2024-02-04T10:47:00.0000000Z",
				"2024-02-04T10:48:00.0000000Z",
				"2024-02-04T10:49:00.0000000Z",
				"2024-02-04T10:50:00.0000000Z",
				"2024-02-04T10:51:00.0000000Z",
				"2024-02-04T10:52:00.0000000Z",
				"2024-02-04T10:53:00.0000000Z",
				"2024-02-04T10:54:00.0000000Z",
				"2024-02-04T10:55:00.0000000Z",
				"2024-02-04T10:56:00.0000000Z",
				"2024-02-04T10:57:00.0000000Z",
				"2024-02-04T10:58:00.0000000Z",
				"2024-02-04T10:59:00.0000000Z",
				"2024-02-04T11:00:00.0000000Z",
				"2024-02-04T11:01:00.0000000Z",
				"2024-02-04T11:02:00.0000000Z",
				"2024-02-04T11:03:00.0000000Z",
				"2024-02-04T11:04:00.0000000Z",
				"2024-02-04T11:05:00.0000000Z",
				"2024-02-04T11:06:00.0000000Z",
				"2024-02-04T11:07:00.0000000Z",
				"2024-02-04T11:08:00.0000000Z",
				"2024-02-04T11:09:00.0000000Z",
				"2024-02-04T11:10:00.0000000Z",
				"2024-02-04T11:11:00.0000000Z",
				"2024-02-04T11:12:00.0000000Z",
				"2024-02-04T11:13:00.0000000Z",
				"2024-02-04T11:14:00.0000000Z",
				"2024-02-04T11:15:00.0000000Z",
				"2024-02-04T11:16:00.0000000Z",
				"2024-02-04T11:17:00.0000000Z",
				"2024-02-04T11:18:00.0000000Z",
				"2024-02-04T11:19:00.0000000Z",
				"2024-02-04T11:20:00.0000000Z",
				"2024-02-04T11:21:00.0000000Z",
				"2024-02-04T11:22:00.0000000Z",
				"2024-02-04T11:23:00.0000000Z",
				"2024-02-04T11:24:00.0000000Z",
				"2024-02-04T11:25:00.0000000Z",
				"2024-02-04T11:26:00.0000000Z",
				"2024-02-04T11:27:00.0000000Z",
				"2024-02-04T11:28:00.0000000Z",
				"2024-02-04T11:29:00.0000000Z",
				"2024-02-04T11:30:00.0000000Z",
				"2024-02-04T11:31:00.0000000Z",
				"2024-02-04T11:32:00.0000000Z",
				"2024-02-04T11:33:00.0000000Z",
				"2024-02-04T11:34:00.0000000Z",
				"2024-02-04T11:35:00.0000000Z",
				"2024-02-04T11:36:00.0000000Z",
				"2024-02-04T11:37:00.0000000Z"
			],
			"datasets": [
				{
					"label": "Total",
					"backgroundColor": "rgba(102, 153, 255, 0.1)",
					"borderColor": "rgb(102, 153, 255)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						4,
						6,
						13,
						9,
						27,
						9,
						11,
						15,
						9,
						10,
						5,
						9,
						5,
						17,
						6,
						9,
						61,
						23,
						9,
						21,
						8,
						20,
						5,
						7,
						35,
						26,
						33,
						20,
						7,
						12,
						4,
						14,
						3,
						19,
						37,
						10,
						18,
						12,
						7,
						30,
						47,
						16,
						10,
						3,
						12,
						11,
						37,
						3,
						18,
						22,
						16,
						6,
						15,
						5,
						41,
						13,
						7,
						9,
						17,
						12
					]
				},
				{
					"label": "No Error",
					"backgroundColor": "rgba(92, 184, 92, 0.1)",
					"borderColor": "rgb(92, 184, 92)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						4,
						6,
						11,
						9,
						22,
						6,
						11,
						13,
						9,
						7,
						5,
						7,
						4,
						13,
						5,
						7,
						59,
						22,
						8,
						21,
						8,
						19,
						5,
						7,
						31,
						25,
						24,
						16,
						6,
						12,
						4,
						12,
						3,
						19,
						36,
						8,
						18,
						12,
						7,
						28,
						46,
						16,
						10,
						3,
						11,
						10,
						34,
						2,
						10,
						13,
						11,
						6,
						15,
						5,
						40,
						12,
						6,
						9,
						14,
						12
					]
				},
				{
					"label": "Server Failure",
					"backgroundColor": "rgba(217, 83, 79, 0.1)",
					"borderColor": "rgb(217, 83, 79)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						1,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0
					]
				},
				{
					"label": "NX Domain",
					"backgroundColor": "rgba(120, 120, 120, 0.1)",
					"borderColor": "rgb(120, 120, 120)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						2,
						0,
						5,
						3,
						0,
						2,
						0,
						3,
						0,
						2,
						1,
						4,
						1,
						2,
						2,
						1,
						1,
						0,
						0,
						1,
						0,
						0,
						4,
						1,
						9,
						4,
						1,
						0,
						0,
						2,
						0,
						0,
						1,
						2,
						0,
						0,
						0,
						2,
						0,
						0,
						0,
						0,
						1,
						1,
						3,
						1,
						8,
						9,
						5,
						0,
						0,
						0,
						1,
						1,
						1,
						0,
						3,
						0
					]
				},
				{
					"label": "Refused",
					"backgroundColor": "rgba(91, 192, 222, 0.1)",
					"borderColor": "rgb(91, 192, 222)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0
					]
				},
				{
					"label": "Authoritative",
					"backgroundColor": "rgba(150, 150, 0, 0.1)",
					"borderColor": "rgb(150, 150, 0)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						1,
						0,
						3,
						1,
						0,
						2,
						1,
						1,
						0,
						1,
						0,
						2,
						1,
						1,
						1,
						1,
						2,
						0,
						0,
						1,
						0,
						0,
						2,
						1,
						3,
						2,
						0,
						0,
						0,
						1,
						0,
						0,
						1,
						1,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						1,
						1,
						1,
						0,
						4,
						4,
						2,
						0,
						2,
						0,
						1,
						1,
						0,
						0,
						0,
						0
					]
				},
				{
					"label": "Recursive",
					"backgroundColor": "rgba(23, 162, 184, 0.1)",
					"borderColor": "rgb(23, 162, 184)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						1,
						3,
						0,
						1,
						14,
						2,
						8,
						4,
						1,
						3,
						2,
						3,
						1,
						3,
						3,
						3,
						36,
						8,
						2,
						14,
						4,
						6,
						1,
						1,
						26,
						17,
						11,
						10,
						2,
						4,
						0,
						8,
						1,
						7,
						18,
						0,
						3,
						0,
						2,
						10,
						6,
						1,
						3,
						1,
						5,
						4,
						20,
						0,
						5,
						7,
						0,
						3,
						7,
						0,
						21,
						7,
						1,
						3,
						6,
						5
					]
				},
				{
					"label": "Cached",
					"backgroundColor": "rgba(111, 84, 153, 0.1)",
					"borderColor": "rgb(111, 84, 153)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						3,
						3,
						11,
						8,
						8,
						4,
						3,
						8,
						7,
						4,
						3,
						4,
						3,
						10,
						2,
						4,
						23,
						14,
						5,
						7,
						4,
						13,
						4,
						6,
						5,
						8,
						13,
						6,
						4,
						8,
						4,
						4,
						2,
						12,
						18,
						8,
						15,
						12,
						5,
						18,
						41,
						15,
						7,
						2,
						6,
						6,
						14,
						2,
						5,
						6,
						10,
						3,
						6,
						5,
						19,
						5,
						5,
						6,
						8,
						7
					]
				},
				{
					"label": "Blocked",
					"backgroundColor": "rgba(255, 165, 0, 0.1)",
					"borderColor": "rgb(255, 165, 0)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						1,
						0,
						2,
						2,
						0,
						1,
						0,
						2,
						0,
						1,
						1,
						2,
						0,
						1,
						1,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						2,
						0,
						6,
						2,
						1,
						0,
						0,
						1,
						0,
						0,
						0,
						1,
						0,
						0,
						0,
						2,
						0,
						0,
						0,
						0,
						0,
						0,
						2,
						1,
						4,
						5,
						4,
						0,
						0,
						0,
						0,
						0,
						1,
						0,
						3,
						0
					]
				},
				{
					"label": "Dropped",
					"backgroundColor": "rgba(30, 30, 30, 0.1)",
					"borderColor": "rgb(30, 30, 30)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0,
						0
					]
				},
				{
					"label": "Clients",
					"backgroundColor": "rgba(51, 122, 183, 0.1)",
					"borderColor": "rgb(51, 122, 183)",
					"borderWidth": 2,
					"fill": true,
					"data": [
						3,
						4,
						3,
						2,
						3,
						4,
						2,
						3,
						3,
						2,
						2,
						3,
						3,
						3,
						2,
						4,
						3,
						2,
						2,
						2,
						2,
						2,
						2,
						2,
						3,
						2,
						3,
						3,
						2,
						2,
						2,
						3,
						2,
						2,
						3,
						3,
						1,
						3,
						3,
						3,
						3,
						3,
						3,
						2,
						3,
						3,
						4,
						2,
						3,
						4,
						4,
						2,
						4,
						3,
						3,
						3,
						3,
						2,
						2,
						3
					]
				}
			]
		},
		"queryResponseChartData": {
			"labels": [
				"Authoritative",
				"Recursive",
				"Cached",
				"Blocked",
				"Dropped"
			],
			"datasets": [
				{
					"data": [
						47,
						348,
						481,
						49,
						0
					],
					"backgroundColor": [
						"rgba(150, 150, 0, 0.5)",
						"rgba(23, 162, 184, 0.5)",
						"rgba(111, 84, 153, 0.5)",
						"rgba(255, 165, 0, 0.5)",
						"rgba(7, 7, 7, 0.5)"
					]
				}
			]
		},
		"queryTypeChartData": {
			"labels": [
				"A",
				"HTTPS",
				"AAAA",
				"SOA",
				"SRV"
			],
			"datasets": [
				{
					"data": [
						683,
						196,
						42,
						2,
						2
					],
					"backgroundColor": [
						"rgba(102, 153, 255, 0.5)",
						"rgba(92, 184, 92, 0.5)",
						"rgba(7, 7, 7, 0.5)",
						"rgba(91, 192, 222, 0.5)",
						"rgba(150, 150, 0, 0.5)",
						"rgba(23, 162, 184, 0.5)",
						"rgba(111, 84, 153, 0.5)",
						"rgba(255, 165, 0, 0.5)",
						"rgba(51, 122, 183, 0.5)",
						"rgba(150, 150, 150, 0.5)"
					]
				}
			]
		},
		"protocolTypeChartData": {
			"labels": [
				"Udp"
			],
			"datasets": [
				{
					"data": [
						925
					],
					"backgroundColor": [
						"rgba(111, 84, 153, 0.5)",
						"rgba(150, 150, 0, 0.5)",
						"rgba(23, 162, 184, 0.5)",
						"rgba(255, 165, 0, 0.5)",
						"rgba(91, 192, 222, 0.5)"
					]
				}
			]
		},
		"topClients": [
			{
				"name": "192.168.10.5",
				"domain": "server1.home",
				"hits": 463,
				"rateLimited": false
			},
			{
				"name": "192.168.10.12",
				"domain": "vostro1.home",
				"hits": 236,
				"rateLimited": false
			},
			{
				"name": "192.168.10.13",
				"hits": 165,
				"rateLimited": false
			},
			{
				"name": "192.168.10.11",
				"domain": "shreyas-zare.home",
				"hits": 53,
				"rateLimited": false
			},
			{
				"name": "192.168.10.15",
				"domain": "android-9c3d70b130d99b94.home",
				"hits": 6,
				"rateLimited": false
			},
			{
				"name": "192.168.10.2",
				"domain": "pi1.home",
				"hits": 2,
				"rateLimited": false
			}
		],
		"topDomains": [
			{
				"name": "hses7-vod-cf-ace.cdn.hotstar.com",
				"hits": 114
			},
			{
				"name": "bifrost-api.hotstar.com",
				"hits": 61
			},
			{
				"name": "edge.microsoft.com",
				"hits": 52
			},
			{
				"name": "www.google.com",
				"hits": 34
			},
			{
				"name": "www.hotstar.com",
				"hits": 24
			},
			{
				"name": "safebrowsing.googleapis.com",
				"hits": 15
			},
			{
				"name": "www.bing.com",
				"hits": 14
			},
			{
				"name": "go.microsoft.com",
				"hits": 14
			},
			{
				"name": "graph.facebook.com",
				"hits": 13
			},
			{
				"name": "substrate.office.com",
				"hits": 11
			}
		],
		"topBlockedDomains": [
			{
				"name": "mobile.pipe.aria.microsoft.com",
				"hits": 10
			},
			{
				"name": "in.api.glance.inmobi.com",
				"hits": 9
			},
			{
				"name": "in.analytics.glance.inmobi.com",
				"hits": 6
			},
			{
				"name": "app-measurement.com",
				"hits": 4
			},
			{
				"name": "googleads.g.doubleclick.net",
				"hits": 4
			},
			{
				"name": "analytics.swiggy.com",
				"hits": 2
			},
			{
				"name": "firebase-settings.crashlytics.com",
				"hits": 2
			},
			{
				"name": "cdn.cookielaw.org",
				"hits": 2
			},
			{
				"name": "m.urbancompany.com",
				"hits": 1
			},
			{
				"name": "beacons.gvt2.com",
				"hits": 1
			}
		]
	},
	"status": "ok"
}
```

### Get Top Stats

Returns the top stats data for specified stats type.

URL:\
`http://localhost:5380/api/dashboard/stats/getTop?token=x&type=LastHour&statsType=TopClients&limit=1000`

OBSOLETE PATH:\
`/api/getTopStats`

PERMISSIONS:\
Dashboard: View

WHERE:
- `token`: The session token generated by the `login` or the `createToken` call.
- `type` (optional): The duration type for which valid values are: [`LastHour`, `LastDay`, `LastWeek`, `LastMonth`, `LastYear`, `custom`]. Default value is `LastHour`.
- `start` (optional): The start date in ISO 8601 format. Applies only to `custom` type.
- `end` (optional): The end date in ISO 8601 format. Applies only to `custom` type.
- `statsType`: The stats type for which valid values are : [`TopClients`, `TopDomains`, `TopBlockedDomains`]
- `limit` (optional): The limit of records to return. Default value is `1000`.
- `noReverseLookup` (optional): Set to `true` to disable reverse lookup for Top Clients list. This option is only applicable with `TopClients` stats type.
- `onlyRateLimitedClients` (optional): Set to `true` to list only clients which are being rate limited in the Top Clients list. This option is only applicable with `TopClients` stats type.

RESPONSE:
The response json will include the object with definition same in the `getStats` response depending on the `statsType`. For example below is the response for `TopClients`:
```
{
	"response": {
		"topClients": [
			{
				"name": "192.168.10.5",
				"domain": "server1.local",
				"hits": 236,
				"rateLimited": false
			},
			{
				"name": "192.168.10.4",
				"domain": "nas1.local",
				"hits": 16,
				"rateLimited": false
			},
			{
				"name": "192.168.10.6",
				"domain": "server2.local",
				"hits": 14,
				"rateLimited": false
			},
			{
				"name": "192.168.10.3",
				"domain": "nas2.local",
				"hits": 12,
				"rateLimited": false
			},
			{
				"name": "217.31.193.175",
				"domain": "condor175.knot-resolver.cz",
				"hits": 10,
				"rateLimited": false
			},
			{
				"name": "162.158.180.45",
				"hits": 9,
				"rateLimited": false
			},
			{
				"name": "217.31.193.163",
				"domain": "gondor-resolver.labs.nic.cz",
				"hits": 9,
				"rateLimited": false
			},
			{
				"name": "210.245.24.68",
				"hits": 8,
				"rateLimited": false
			},
			{
				"name": "101.91.16.140",
				"hits": 8,
				"rateLimited": false
			}
		],
	},
	"status": "ok"
}
```

### Delete All Stats

Permanently delete all hourly and daily stats files from the disk and clears all stats stored in memory. This call will clear all stats from the Dashboard.

URL:\
`http://localhost:5380/api/dashboard/stats/deleteAll?token=x`

OBSOLETE PATH:\
`/api/deleteAllStats`

PERMISSIONS:\
Dashboard: Delete

WHERE:
- `token`: The session token generated by the `login` or the `createToken` call.

RESPONSE:
```
{
	"response": {},
	"status": "ok"
}
```


